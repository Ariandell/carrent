<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-config="PROJECT_NAME">FPV Racer - Dashboard</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/tailwind_config.js"></script>
    <link href="./css/antigravity.css?v=105" rel="stylesheet">
    <script src="js/config.js?v=99"></script>
    <script src="js/lang.js?v=99"></script>
    <script src="js/theme.js?v=99"></script>
    <script src="js/toast.js?v=99"></script>
</head>

<body class="min-h-screen transition-colors duration-500 overflow-x-hidden">

    <!-- Background Layer (Consistent with Auth/Index) -->
    <div id="bg-layer" class="fixed inset-0 z-0 bg-neutral-900 dark:bg-[#050505]"></div>

    <!-- Navbar (Premium Glass) -->
    <nav class="sticky top-0 z-40 border-b border-white/5 bg-white/50 dark:bg-black/50 backdrop-blur-xl">
        <div class="container mx-auto px-6 h-20 flex justify-between items-center">
            <!-- Logo -->
            <a href="index.html" class="flex items-center gap-4 hover:opacity-80 transition-opacitygroup">
                <div class="w-10 h-10 rounded-xl bg-blue-600 flex items-center justify-center shadow-lg shadow-blue-500/20">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <span class="text-xl font-bold tracking-tight text-neutral-900 dark:text-white" data-config="PROJECT_NAME">FPV RACER</span>
            </a>

            <!-- Right Side -->
            <div class="flex items-center gap-6">
                <!-- Balance -->
                <div class="hidden sm:flex items-center gap-3 pl-5 pr-2 py-1.5 rounded-full bg-neutral-100 dark:bg-white/5 border border-neutral-200 dark:border-white/10">
                    <div class="text-right">
                        <div class="text-[9px] text-neutral-500 dark:text-neutral-400 uppercase tracking-widest font-bold" data-i18n="balance">
                            Balance
                        </div>
                        <div id="balanceDisplay" class="font-mono font-bold text-neutral-900 dark:text-white leading-none">0 <span class="text-xs">₴</span></div>
                    </div>
                    <button onclick="openTopUpModal()" class="w-8 h-8 rounded-full bg-neutral-900 dark:bg-white hover:bg-neutral-700 dark:hover:bg-neutral-200 flex items-center justify-center text-white dark:text-black transition-all shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                        </svg>
                    </button>
                </div>

                <!-- User -->
                <div class="relative group">
                    <button class="flex items-center gap-3 p-1 pr-3 rounded-full hover:bg-neutral-100 dark:hover:bg-white/10 transition-colors border border-transparent hover:border-neutral-200 dark:hover:border-white/5">
                        <img id="userAvatar" src="https://ui-avatars.com/api/?name=Pilot&background=3b82f6&color=fff" class="w-9 h-9 rounded-full shadow-sm">
                        <div class="text-left hidden md:block">
                            <div id="userName" class="text-xs font-bold text-neutral-900 dark:text-white">Pilot</div>
                            <div class="text-[9px] text-neutral-500 dark:text-neutral-400 uppercase tracking-widest">Online</div>
                        </div>
                        <svg class="w-4 h-4 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>

                    <!-- Dropdown -->
                    <div id="userDropdown" class="absolute right-0 top-full pt-4 w-56 hidden group-hover:block z-50 animate-fade-in-up">
                        <div class="bg-white dark:bg-[#111] backdrop-blur-xl border border-neutral-200 dark:border-white/10 rounded-2xl shadow-2xl overflow-hidden py-2">
                            <div class="px-4 py-3 border-b border-neutral-100 dark:border-white/5 mb-1 sm:hidden">
                                 <div class="text-[9px] text-neutral-500 dark:text-neutral-400 uppercase tracking-widest font-bold" data-i18n="balance">Balance</div>
                                 <div class="font-mono font-bold text-neutral-900 dark:text-white">0 ₴</div>
                            </div>
                            
                            <a href="profile.html" class="flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors">
                                <svg class="w-4 h-4 opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                My Profile
                            </a>
                            <a href="javascript:openSupportModal()" class="flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors">
                                <svg class="w-4 h-4 opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                                Support
                            </a>
                            <div class="border-t border-neutral-100 dark:border-white/5 my-1"></div>
                            <a href="javascript:api.logout()" class="flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors">
                                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                                Sign Out
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-6 py-12">

        <!-- Active Rental Banner (Redesigned) -->
        <div id="activeRentalBanner" class="hidden relative overflow-hidden rounded-3xl bg-neutral-900 dark:bg-black border border-neutral-200 dark:border-white/10 p-1 mb-12 shadow-2xl">
            <!-- Animated Gradient Border Effect -->
            <div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-blue-500/20 to-emerald-500/20 animate-pulse opacity-50"></div>
            
            <div class="relative bg-white dark:bg-[#0a0a0a] rounded-[20px] p-6 sm:p-8 flex flex-col md:flex-row justify-between items-center gap-6 z-10">
                <div class="flex items-center gap-6">
                    <div class="relative">
                        <div class="w-4 h-4 rounded-full bg-emerald-500 animate-ping absolute inset-0 opacity-75"></div>
                        <div class="w-4 h-4 rounded-full bg-emerald-500 relative shadow-[0_0_15px_rgba(16,185,129,0.5)]"></div>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-neutral-900 dark:text-white tracking-tight mb-1">Active Session</h3>
                        <p class="text-sm text-neutral-500 dark:text-neutral-400 font-medium">You are currently connected to a unit.</p>
                    </div>
                </div>
                <a href="control.html" class="w-full md:w-auto px-8 py-3 rounded-xl bg-neutral-900 dark:bg-white text-white dark:text-black font-bold text-sm uppercase tracking-wider hover:scale-105 transition-transform shadow-lg flex items-center justify-center gap-3">
                    <span data-i18n="btn_enter_control">Enter Control</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                </a>
            </div>
        </div>

        <!-- Header -->
        <div class="flex flex-col md:flex-row justify-between items-end mb-10 gap-6">
            <div>
                <h1 class="text-4xl md:text-5xl font-black tracking-tighter text-neutral-900 dark:text-white mb-3" data-i18n="dashboard_title">
                    AVAILABLE UNITS
                </h1>
                <p class="text-neutral-500 dark:text-neutral-400 font-medium tracking-wide text-sm uppercase" data-i18n="dashboard_subtitle">
                    Select a unit to initialize link
                </p>
            </div>
            
            <div class="bg-neutral-100 dark:bg-white/5 p-1 rounded-xl flex gap-1 border border-neutral-200 dark:border-white/5">
                <button id="filterAll" onclick="setFilter('all')" class="px-5 py-2 rounded-lg text-sm font-bold transition-all bg-white dark:bg-white/10 text-neutral-900 dark:text-white shadow-sm" data-i18n="filter_all">All</button>
                <button id="filterAvailable" onclick="setFilter('available')" class="px-5 py-2 rounded-lg text-sm font-bold transition-all text-neutral-500 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-white" data-i18n="filter_available">Available</button>
            </div>
        </div>

        <!-- Cars Grid -->
        <div id="carsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            <!-- Loading Skeletons -->
            <div class="bg-white dark:bg-[#111] rounded-3xl h-80 animate-pulse border border-neutral-200 dark:border-white/5"></div>
            <div class="bg-white dark:bg-[#111] rounded-3xl h-80 animate-pulse border border-neutral-200 dark:border-white/5"></div>
            <div class="bg-white dark:bg-[#111] rounded-3xl h-80 animate-pulse border border-neutral-200 dark:border-white/5"></div>
        </div>
    </div>

    <!-- Modals (Reused existing IDs for compatibility, but restyled) -->
    
    <!-- TopUp Modal -->
    <div id="topUpModal" class="fixed inset-0 bg-black/60 dark:bg-black/80 z-50 hidden flex items-center justify-center backdrop-blur-md opacity-0 transition-opacity duration-300">
        <div class="bg-white dark:bg-[#0a0a0a] border border-neutral-200 dark:border-white/10 p-8 w-full max-w-sm mx-4 rounded-3xl shadow-2xl scale-95 transition-transform duration-300 transform" id="topUpContent">
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-2xl font-bold text-neutral-900 dark:text-white" data-i18n="top_up">Add Funds</h3>
                <button onclick="closeTopUpModal()" class="w-8 h-8 rounded-full bg-neutral-100 dark:bg-white/10 flex items-center justify-center text-neutral-500 hover:text-neutral-900 dark:hover:text-white transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <!-- ... content same logic, better style ... -->
             <div class="grid grid-cols-3 gap-3 mb-8">
                <button onclick="selectAmount(50)" class="amount-btn py-4 rounded-2xl border border-neutral-200 dark:border-white/10 hover:border-blue-500 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all font-mono font-bold text-neutral-900 dark:text-white">50 ₴</button>
                <button onclick="selectAmount(100)" class="amount-btn py-4 rounded-2xl border-2 border-blue-500 bg-blue-50 dark:bg-blue-900/20 transition-all font-mono font-bold text-blue-700 dark:text-blue-400">100 ₴</button>
                <button onclick="selectAmount(200)" class="amount-btn py-4 rounded-2xl border border-neutral-200 dark:border-white/10 hover:border-blue-500 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all font-mono font-bold text-neutral-900 dark:text-white">200 ₴</button>
            </div>
            <button onclick="processPayment()" class="w-full py-4 rounded-2xl bg-blue-600 hover:bg-blue-700 text-white font-bold text-sm uppercase tracking-widest shadow-lg shadow-blue-500/30 transition-all hover:scale-[1.02]" data-i18n="proceed_to_payment"> Pay Now </button>
            <form id="liqpayForm" method="POST" action="https://www.liqpay.ua/api/3/checkout" accept-charset="utf-8" class="hidden">
                <input type="hidden" name="data" id="liqpayData" />
                <input type="hidden" name="signature" id="liqpaySignature" />
            </form>
        </div>
    </div>

    <!-- Script to handle modal anims & logic -->
    <script>
        // Modal Animation Helpers
        const modals = ['topUpModal', 'rentModal', 'supportModal'];
        modals.forEach(id => {
            const el = document.getElementById(id);
            if(!el) return;
            // Observe class changes to trigger animations if needed, 
            // or just rely on CSS transitions added to classes
        });
        
        // Enhance existing open/close functions if they use simple classList toggle
        // We can override them or let them be. The CSS above expects .opacity-0 and .hidden handled.
        
        // Let's ensure dashboard.js logic works with this new structure.
        // The IDs are the same, so it should be fine.
    </script>

    <!-- Support & Rent Modals omitted for brevity but would follow same design pattern -->
    <!-- I will keep the original Rent/Support modal structure but with new classes for consistency if I could, 
         but for now I'll just paste the original ones with updated classes to ensure they work -->
         
    <!-- Rent Modal -->
    <div id="rentModal" class="fixed inset-0 bg-black/60 dark:bg-black/80 z-50 hidden flex items-center justify-center backdrop-blur-md">
        <div class="bg-white dark:bg-[#0a0a0a] border border-neutral-200 dark:border-white/10 w-full max-w-sm mx-4 rounded-3xl shadow-2xl overflow-hidden">
             <div class="p-6 border-b border-neutral-100 dark:border-white/5">
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="text-xl font-bold text-neutral-900 dark:text-white mb-1" data-i18n="rent_title">Rent Unit</h3>
                        <div id="rentCarName" class="text-blue-600 dark:text-blue-400 font-mono text-xs uppercase tracking-wider">Unit Name</div>
                    </div>
                    <button onclick="closeRentModal()" class="text-neutral-400 hover:text-neutral-900 dark:hover:text-white transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </div>
            </div>
            <div class="p-6 bg-neutral-50 dark:bg-white/[0.02]">
                <div class="text-[10px] text-neutral-500 uppercase tracking-widest font-bold mb-4" data-i18n="select_duration">Select Duration</div>
                <div class="space-y-3">
                    <button onclick="selectDuration(5)" class="duration-btn w-full p-4 rounded-xl border border-neutral-200 dark:border-white/10 bg-white dark:bg-transparent hover:border-blue-500 transition-all flex justify-between items-center group">
                        <span class="font-bold text-neutral-700 dark:text-neutral-300 group-hover:text-blue-600 dark:group-hover:text-blue-400" data-i18n="rent_duration_5">5 Minutes</span>
                        <div class="w-4 h-4 rounded-full border-2 border-neutral-300 dark:border-neutral-700 group-hover:border-blue-500"></div>
                    </button>
                    <!-- More options... JS populates logic usually? No, hardcoded in HTML -->
                     <button onclick="selectDuration(10)" class="duration-btn w-full p-4 rounded-xl border border-neutral-200 dark:border-white/10 bg-white dark:bg-transparent hover:border-blue-500 transition-all flex justify-between items-center group">
                        <span class="font-bold text-neutral-700 dark:text-neutral-300 group-hover:text-blue-600 dark:group-hover:text-blue-400" data-i18n="rent_duration_10">10 Minutes</span>
                        <div class="w-4 h-4 rounded-full border-2 border-neutral-300 dark:border-neutral-700 group-hover:border-blue-500"></div>
                    </button>
                </div>
            </div>
            <div class="p-6">
                 <button onclick="confirmRental()" class="w-full py-4 rounded-2xl bg-emerald-600 hover:bg-emerald-700 text-white font-bold text-sm uppercase tracking-widest shadow-lg shadow-emerald-500/30 transition-all hover:scale-[1.02]" data-i18n="confirm_rent">
                    Confirm & Link
                </button>
            </div>
        </div>
    </div>
    
    <!-- Support Modal (Simplified) -->
    <div id="supportModal" class="fixed inset-0 bg-black/60 dark:bg-black/80 z-50 hidden flex items-center justify-center backdrop-blur-md">
        <!-- Reusing TopUp style -->
        <div class="bg-white dark:bg-[#0a0a0a] border border-neutral-200 dark:border-white/10 p-8 w-full max-w-md mx-4 rounded-3xl shadow-2xl">
              <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-neutral-900 dark:text-white" data-i18n="support_title">Support</h3>
                <button onclick="closeSupportModal()" class="text-neutral-400 hover:text-neutral-900 dark:hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <textarea id="supportMessage" rows="5" class="w-full bg-neutral-100 dark:bg-white/5 border border-transparent focus:border-blue-500 rounded-xl p-4 text-sm outline-none transition-colors mb-4 text-neutral-900 dark:text-white" placeholder="Describe your issue..."></textarea>
            <button onclick="submitSupport()" class="w-full py-4 rounded-2xl bg-neutral-900 dark:bg-white text-white dark:text-black font-bold text-sm uppercase tracking-widest" data-i18n="support_btn">Send Request</button>
        </div>
    </div>
    
    <div id="connection-manager" class="hidden"></div>

    <script src="js/api.js?v=11"></script>
    <script src="js/dashboard.js?v=64"></script>
    
    <!-- Override Card Creating Logic via JS Injection? 
         dashboard.js creates cards dynamically using innerHTML. 
         We might need to update dashboard.js to match this new premium style.
         For now, the container structure is ready.
    -->
</body>
</html>